{
  "artifact_id": "7c08bd5a-9677-48b9-8bef-10709009a441",
  "artifact_version_id": "7c08bd5a-9677-48b9-8bef-10709009a441-v001",
  "description": "Mercy Blade multilingual moderation rules (EN/VI) with obfuscation handling, context gates, and escalation policy.",
  "policy": {
    "severity_levels": {
      "1": "mild profanity / coarse language",
      "2": "direct insult / harassment",
      "3": "sexual explicitness / graphic profanity",
      "4": "violent threats / targeted harassment",
      "5": "hate slurs / sexual violence / child exploitation"
    },
    "actions": [
      {
        "score_gte": 1,
        "window_hours": 24,
        "action": "warn",
        "message_en": "‚ö†Ô∏è Language not allowed in Mercy Blade. Please be respectful.",
        "message_vi": "‚ö†Ô∏è Ng√¥n t·ª´ n√†y kh√¥ng ƒë∆∞·ª£c ph√©p tr√™n Mercy Blade. Vui l√≤ng d√πng l·ªùi l·∫Ω l·ªãch s·ª±."
      },
      {
        "score_gte": 2,
        "window_hours": 24,
        "action": "temp_mute_24h",
        "message_en": "üö´ Second violation in 24h. You are muted for 24 hours.",
        "message_vi": "üö´ Vi ph·∫°m l·∫ßn 2 trong 24 gi·ªù. T√†i kho·∫£n c·ªßa b·∫°n b·ªã t·∫Øt ti·∫øng 24 gi·ªù."
      },
      {
        "score_gte": 3,
        "window_hours": 24,
        "action": "suspend_review",
        "message_en": "‚õî Multiple or severe violations. Account suspended pending review.",
        "message_vi": "‚õî Vi ph·∫°m nhi·ªÅu l·∫ßn ho·∫∑c nghi√™m tr·ªçng. T√†i kho·∫£n b·ªã t·∫°m kh√≥a ƒë·ªÉ xem x√©t."
      }
    ],
    "scoring": {
      "severity1": 1,
      "severity2": 1,
      "severity3": 2,
      "severity4": 2,
      "severity5": 3
    },
    "reset_after_days": 30
  },
  "normalization_pipeline": [
    "unicode_nfkc",
    "lowercase",
    "strip_zero_width",
    "remove_urls",
    "remove_emails",
    "remove_accents",
    "map_leetspeak",
    "collapse_repeats",
    "collapse_whitespace"
  ],
  "context_gates": {
    "allow_if_medical_en": [
      {
        "regex": "sexual (health|education)",
        "window_tokens": 8
      },
      {
        "regex": "breastfeeding|lactation",
        "window_tokens": 8
      },
      {
        "regex": "prostate exam|gynecology|urology",
        "window_tokens": 10
      }
    ],
    "allow_if_medical_vi": [
      {
        "regex": "s·ª©c kho·∫ª sinh s·∫£n|gi√°o d·ª•c gi·ªõi t√≠nh|t∆∞ v·∫•n t√¨nh d·ª•c",
        "window_tokens": 10
      },
      {
        "regex": "kh√°m tuy·∫øn ti·ªÅn li·ªát|ph·ª• khoa|ti·∫øt ni·ªáu",
        "window_tokens": 10
      }
    ]
  },
  "rules": [
    {
      "id": "en_prof_1",
      "lang": "en",
      "category": "profanity",
      "severity": 1,
      "patterns": [
        "\\bass(es)?\\b",
        "\\b(crap|shit+)\\b",
        "\\b(hell|damn)\\b"
      ],
      "examples": {
        "flag": [
          "what the hell",
          "this is crap"
        ],
        "allow": [
          "class",
          "passage"
        ]
      }
    },
    {
      "id": "en_prof_2",
      "lang": "en",
      "category": "profanity",
      "severity": 2,
      "patterns": [
        "\\b(bitch(es)?|bastard(s)?)\\b",
        "\\b(dick|prick)\\b"
      ],
      "examples": {
        "flag": [
          "you bastard",
          "stop being a bitch"
        ],
        "allow": [
          "bastard file (false positive)"
        ]
      }
    },
    {
      "id": "en_prof_3",
      "lang": "en",
      "category": "profanity",
      "severity": 3,
      "patterns": [
        "\\bfuck(ing|er|s)?\\b",
        "\\bmotherfucker(s)?\\b",
        "\\bcunt(s)?\\b"
      ],
      "examples": {
        "flag": [
          "f*** you",
          "motherfucker"
        ],
        "allow": [
          "fuchsia (should not hit)"
        ]
      }
    },
    {
      "id": "en_harass_1",
      "lang": "en",
      "category": "harassment",
      "severity": 2,
      "patterns": [
        "\\b(stupid|idiot|moron|retard)\\b",
        "\\b(loser|worthless)\\b"
      ],
      "examples": {
        "flag": [
          "you are stupid"
        ],
        "allow": [
          "stupendous (not)"
        ]
      }
    },
    {
      "id": "en_threat_1",
      "lang": "en",
      "category": "violence_threat",
      "severity": 4,
      "patterns": [
        "\\b(kill|stab|shoot|hang|lynch)\\b.+\\byou\\b",
        "\\b(go|drop) die\\b",
        "\\bkys\\b"
      ],
      "examples": {
        "flag": [
          "i will kill you"
        ],
        "allow": [
          "kill process (context whitelist could exempt)"
        ]
      }
    },
    {
      "id": "en_hate_1",
      "lang": "en",
      "category": "hate_slur",
      "severity": 5,
      "patterns": [
        "\\b(nigger|nigga|kike|chink|spic)\\b"
      ],
      "examples": {
        "flag": [
          "you kike"
        ],
        "allow": [
          "‚Äî"
        ]
      }
    },
    {
      "id": "en_sex_1",
      "lang": "en",
      "category": "sexual_explicit",
      "severity": 3,
      "patterns": [
        "\\b(pussy|cock|dick|cum|handjob|blowjob|anal|dildo|porn(o)?)\\b"
      ],
      "context_allow": [
        "allow_if_medical_en"
      ],
      "examples": {
        "flag": [
          "send porn"
        ],
        "allow": [
          "sexual health education"
        ]
      }
    },
    {
      "id": "en_sex_2",
      "lang": "en",
      "category": "sexual_violence",
      "severity": 5,
      "patterns": [
        "\\brape\\b|\\bmolest\\b|\\bincest\\b|\\bpedophile\\b"
      ],
      "examples": {
        "flag": [
          "i will rape you"
        ],
        "allow": [
          "‚Äî"
        ]
      }
    },
    {
      "id": "en_obfus_1",
      "lang": "en",
      "category": "profanity_obfuscated",
      "severity": 3,
      "patterns": [
        "\\bf[\\W_]*u[\\W_]*c[\\W_]*k\\b",
        "\\bc[\\W_]*u[\\W_]*n[\\W_]*t\\b"
      ],
      "examples": {
        "flag": [
          "f.u.c.k",
          "c__u__n__t"
        ],
        "allow": [
          "f/u for follow-up (context)"
        ]
      }
    },
    {
      "id": "vi_prof_1",
      "lang": "vi",
      "category": "profanity",
      "severity": 1,
      "patterns": [
        "\\b(ƒë·ªì|ƒë·ª©a)\\s+(ngu|kh√πng|ƒëi√™n)\\b",
        "\\bƒë·ªì\\s+√≥c\\s+ch√≥\\b"
      ],
      "examples": {
        "flag": [
          "ƒë·ªì ngu"
        ],
        "allow": [
          "ngu·ªôi (not)"
        ]
      }
    },
    {
      "id": "vi_prof_2",
      "lang": "vi",
      "category": "profanity",
      "severity": 2,
      "patterns": [
        "\\b(ƒë·ªãt|ƒë·ª•|ƒë√©o)\\b",
        "\\b(con|th·∫±ng)\\s+(ƒëi·∫øm|kh·ªën|m·∫•t d·∫°y)\\b"
      ],
      "examples": {
        "flag": [
          "ƒë·ªãt m·∫π m√†y"
        ],
        "allow": [
          "ƒëi·∫øm s·ªë h·ªçc (not)"
        ]
      }
    },
    {
      "id": "vi_prof_3",
      "lang": "vi",
      "category": "profanity",
      "severity": 3,
      "patterns": [
        "\\b(c·∫∑c|l·ªìn|bu·ªìi)\\b",
        "\\bƒë·ª•\\s*m[a√†]\\b"
      ],
      "examples": {
        "flag": [
          "c·∫∑c"
        ],
        "allow": [
          "‚Äî"
        ]
      }
    },
    {
      "id": "vi_harass_1",
      "lang": "vi",
      "category": "harassment",
      "severity": 2,
      "patterns": [
        "\\b(m√†y|t·ª•i m√†y).*(ngu|ƒë·ªì r√°c r∆∞·ªüi|ƒë√°ng khinh)\\b"
      ],
      "examples": {
        "flag": [
          "m√†y ƒë√°ng khinh"
        ],
        "allow": [
          "‚Äî"
        ]
      }
    },
    {
      "id": "vi_threat_1",
      "lang": "vi",
      "category": "violence_threat",
      "severity": 4,
      "patterns": [
        "\\b(tao)\\s*(s·∫Ω)?\\s*(gi·∫øt|ƒë√¢m|ƒë√°nh|ƒë·ªët)\\s*(m√†y|b·ªçn m√†y)\\b",
        "\\bƒëi ch·∫øt ƒëi\\b"
      ],
      "examples": {
        "flag": [
          "tao s·∫Ω gi·∫øt m√†y"
        ],
        "allow": [
          "‚Äî"
        ]
      }
    },
    {
      "id": "vi_sex_1",
      "lang": "vi",
      "category": "sexual_explicit",
      "severity": 3,
      "patterns": [
        "\\b(ch·ªãch|ƒë·ªãt|hi·∫øp|d√¢m|ƒë·ªìi tr·ª•y|porn|sex)\\b"
      ],
      "context_allow": [
        "allow_if_medical_vi"
      ],
      "examples": {
        "flag": [
          "xem porn"
        ],
        "allow": [
          "gi√°o d·ª•c gi·ªõi t√≠nh"
        ]
      }
    },
    {
      "id": "vi_sex_2",
      "lang": "vi",
      "category": "sexual_violence",
      "severity": 5,
      "patterns": [
        "\\b(hi·∫øp|c∆∞·ª°ng hi·∫øp|·∫•u d√¢m|lo·∫°n lu√¢n)\\b"
      ],
      "examples": {
        "flag": [
          "tao s·∫Ω hi·∫øp m√†y"
        ],
        "allow": [
          "‚Äî"
        ]
      }
    },
    {
      "id": "vi_obfus_1",
      "lang": "vi",
      "category": "profanity_obfuscated",
      "severity": 3,
      "patterns": [
        "\\bd[\\W_]*i[\\W_]*t\\b",
        "\\bd[\\W_]*e[\\W_]*o\\b"
      ],
      "examples": {
        "flag": [
          "d.i.t"
        ],
        "allow": [
          "‚Äî"
        ]
      }
    }
  ],
  "engine_hints": {
    "regex_flags": [
      "IGNORECASE",
      "UNICODE"
    ],
    "word_boundary": "\\b",
    "preprocessing": {
      "zero_width": [
        "\\u200B",
        "\\u200C",
        "\\u200D",
        "\\uFEFF"
      ],
      "leet_map": {
        "0": "o",
        "1": "i",
        "3": "e",
        "4": "a",
        "5": "s",
        "7": "t",
        "$": "s",
        "@": "a",
        "!": "i"
      },
      "repeat_max": 3
    }
  },
  "storage_contract": {
    "user_behavior_log_fields": [
      "user_id",
      "ts",
      "lang",
      "matched_rule_ids",
      "normalized_text",
      "raw_text",
      "severity_max",
      "score_delta",
      "ip_hash"
    ],
    "privacy": "store normalized + hashed identifiers only; rotate keys monthly"
  },
  "pseudocode_enforcement": {
    "normalize": [
      "t = nfkc(t)",
      "t = lowercase(t)",
      "t = strip_zero_width(t)",
      "t = remove_urls_emails(t)",
      "t = remove_accents(t)",
      "t = map_leetspeak(t)",
      "t = collapse_repeated_chars(t, max=3)",
      "t = collapse_whitespace(t)"
    ],
    "match": [
      "for rule in rules:",
      "  if regex(rule.patterns).any_match(t) and not in_allowlist_context(t, rule.context_allow):",
      "     hits.append(rule)"
    ],
    "score": [
      "severity_max = max(hit.severity)",
      "score_delta = policy.scoring['severity{severity_max}']",
      "apply_escalation(user_id, score_delta, window=24h)"
    ]
  },
  "entries": []
}
